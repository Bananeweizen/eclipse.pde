<?xml version="1.0" encoding="UTF-8"?>
<project name="build template" default="dist">

  <commapatternset id="pattern.id" includes="${includes}" excludes="${excludes}"/>
  <commapatternset id="copy.id" includes="${includes}" excludes="${excludes},**/*.java"/>
  <commapatternset id="includes.id" includes="${includes}"/>
  <commapatternset id="excludes.id" excludes="${excludes}"/>
  <fileset id="file.id" dir="${srcdir}">
    <patternset refid="pattern.id"/>
  </fileset>  
  <stripMapper id="stripMapper.id" from="${mapping}"/>
 
  <target name="jar" depends="">
    <property name="build.compiler" value="org.eclipse.pde.internal.core.JDTCompilerAdapter"/>
    <property name="out" value="${dest}.bin"/>
    <delete dir="${out}"/>
    <mkdir dir="${out}"/>
    <javac srcdir="${srcdir}" destdir="${out}" verbose="yes" failonerror="no">
      <patternset refid="pattern.id"/>
      <classpath path="${rt};${compilePath}"/>
    </javac>
    <copy todir="${out}">
      <fileset dir=".">
         <patternset refid="copy.id"/>
      </fileset>
      <mapper refid="stripMapper.id"/>
    </copy>
    <delete file="${dest}"/>
    <jar jarfile="${dest}" basedir="${out}"/>
    <copy todir="${basedir}">
      <fileset dir="." includes="*.log" />
    </copy>
    <delete dir="${out}"/>
  </target>

  <target name="includesExcludesCopy" depends="">
    <mkdir dir="${dest}"/>
    <copy todir="${dest}">
      <fileset refid="file.id"/>
    </copy>
  </target>

  <target name="src">
    <delete dir="${dest}.pdetemp" />
    <mkdir dir="${dest}.pdetemp" />
    <copy todir="${dest}.pdetemp">
      <fileset refid="file.id"/>
      <mapper refid="stripMapper.id"/>
    </copy>
    <delete file="${dest}"/>
    <zip zipfile="${dest}" basedir="${dest}.pdetemp"/>
    <delete dir="${dest}.pdetemp"/>
  </target>

</project>